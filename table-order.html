<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨ÙˆÙ… Ù¾ÛŒØªØ²Ø§ - Ø³ÛŒØ³ØªÙ… Ù†Ø§ÙˆÛ•ÙˆÛ•</title>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <style>
        :root { --accent: #ff3131; --bg: #0a0b0d; --card: #16181d; --text: #ffffff; --gold: #ffc107; }
        body { font-family: 'Vazirmatn', sans-serif; background-color: var(--bg); color: var(--text); margin: 0; padding-bottom: 50px; }
        
        /* Container & Layout */
        .container { padding: 15px; max-width: 500px; margin: auto; }
        .table-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px; }
        .table-btn { background: var(--card); border: 1px solid #25282e; color: white; padding: 15px 5px; border-radius: 12px; cursor: pointer; transition: 0.3s; }
        .table-btn.active { background: var(--accent); border-color: #fff; }

        .order-form { background: var(--card); padding: 20px; border-radius: 20px; border: 1px solid #25282e; }
        
        /* Selected Items List */
        .selected-list { margin-top: 10px; border-top: 1px solid #333; padding-top: 10px; }
        .item-row { display: flex; justify-content: space-between; align-items: center; background: #1f2229; padding: 10px; margin-bottom: 8px; border-radius: 10px; border-right: 3px solid var(--accent); }
        .item-info { flex-grow: 1; }
        .item-info small { color: var(--gold); display: block; font-size: 0.8rem; }
        .del-btn { color: #ff3131; background: none; border: none; font-size: 1.2rem; cursor: pointer; padding: 0 10px; }

        /* Modals */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000; justify-content: center; align-items: center; }
        .modal-content { background: var(--card); width: 85%; max-width: 350px; padding: 20px; border-radius: 20px; border: 1px solid var(--accent); }
        
        .food-grid { max-height: 300px; overflow-y: auto; }
        .food-item { background: #1f2229; padding: 12px; margin: 5px 0; border-radius: 10px; cursor: pointer; display: flex; justify-content: space-between; }
        
        .qty-input { width: 60px; text-align: center; font-size: 1.5rem; background: #000; color: var(--gold); border: 1px solid #444; border-radius: 8px; padding: 5px; }
        .extra-input { width: 100%; padding: 10px; background: #1f2229; border: 1px solid #333; color: white; border-radius: 8px; margin-top: 10px; font-family: inherit; }

        .btn-main { background: var(--accent); color: white; padding: 15px; border-radius: 12px; border: none; width: 100%; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .btn-cancel { background: #333; color: #fff; padding: 10px; border-radius: 8px; border: none; width: 100%; margin-top: 10px; cursor: pointer; }
    </style>
</head>
<body>

    <div class="container">
        <h2 style="text-align:center; color:var(--accent);">Ø¨ÙˆÙ… Ù¾ÛŒØªØ²Ø§ ğŸ•</h2>
        
        <div class="table-grid">
            <button class="table-btn" onclick="selectDesk(1, this)">Ù…ÛØ²ÛŒ Ù¡</button>
            <button class="table-btn" onclick="selectDesk(2, this)">Ù…ÛØ²ÛŒ Ù¢</button>
            <button class="table-btn" onclick="selectDesk(3, this)">Ù…ÛØ²ÛŒ Ù£</button>
            <button class="table-btn" onclick="selectDesk(4, this)">Ù…ÛØ²ÛŒ Ù¤</button>
            <button class="table-btn" onclick="selectDesk(5, this)">Ù…ÛØ²ÛŒ Ù¥</button>
            <button class="table-btn" onclick="selectDesk(6, this)">Ù…ÛØ²ÛŒ Ù¦</button>
        </div>

        <div class="order-form">
            <button class="btn-main" onclick="openFoodModal()" style="background:#1f2229; border:1px dashed var(--accent);">+ Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ø®ÙˆØ§Ø±Ø¯Ù†</button>
            
            <div class="selected-list" id="selected-list">
                </div>

            <div style="margin-top:20px; border-top:1px solid #333; padding-top:15px;">
                <div style="display:flex; justify-content:space-between; font-weight:bold;">
                    <span>Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ:</span>
                    <span id="display-total" style="color:var(--gold);">0 Ø¯.Ø¹</span>
                </div>
                <button class="btn-main" onclick="sendOrder()">Ù†Ø§Ø±Ø¯Ù†ÛŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ âœ…</button>
            </div>
        </div>
    </div>

    <div id="food-modal" class="modal">
        <div class="modal-content">
            <h3 style="margin-top:0;">Ù„ÛŒØ³ØªÛŒ Ø®ÙˆØ§Ø±Ø¯Ù†</h3>
            <div class="food-grid">
                <div class="food-item" onclick="promptQty('Ù¾ÛŒØªØ²Ø§ Ù…ÛÚ©Ø³', 8000)"><span>Ù¾ÛŒØªØ²Ø§ Ù…ÛÚ©Ø³</span><span>8,000</span></div>
                <div class="food-item" onclick="promptQty('Ù¾ÛŒØªØ²Ø§ Ù¾ÛŒØ±Û†Ù†ÛŒ', 7000)"><span>Ù¾ÛŒØªØ²Ø§ Ù¾ÛŒØ±Û†Ù†ÛŒ</span><span>7,000</span></div>
                <div class="food-item" onclick="promptQty('Ù¾ÛŒØªØ²Ø§ Ù…Ø±ÛŒØ´Ú©', 7500)"><span>Ù¾ÛŒØªØ²Ø§ Ù…Ø±ÛŒØ´Ú©</span><span>7,500</span></div>
                <div class="food-item" onclick="promptQty('Ø¨Û•Ø±Ú¯Ø± Ú¯Û†Ø´Øª', 5000)"><span>Ø¨Û•Ø±Ú¯Ø± Ú¯Û†Ø´Øª</span><span>5,000</span></div>
                <div class="food-item" onclick="promptQty('Ø¨Û•Ø±Ú¯Ø± Ù…Ø±ÛŒØ´Ú©', 4500)"><span>Ø¨Û•Ø±Ú¯Ø± Ù…Ø±ÛŒØ´Ú©</span><span>4,500</span></div>
                <div class="food-item" onclick="promptQty('ÙÛŒÙ†Ú¯Û•Ø±', 2500)"><span>ÙÛŒÙ†Ú¯Û•Ø±</span><span>2,500</span></div>
                <div class="food-item" onclick="promptQty('Ù¾ÛÙ¾Ø³ÛŒ', 500)"><span>Ù¾ÛÙ¾Ø³ÛŒ</span><span>500</span></div>
            </div>
            <button class="btn-cancel" onclick="closeModal('food-modal')">Ø¯Ø§Ø®Ø³ØªÙ†</button>
        </div>
    </div>

    <div id="qty-modal" class="modal">
        <div class="modal-content" style="text-align:center;">
            <h3 id="modal-food-name">Ù†Ø§Ùˆ</h3>
            <div style="display:flex; align-items:center; justify-content:center; gap:15px; margin:15px 0;">
                <span style="font-size:0.9rem; color:#888;">Ø¨Ú•:</span>
                <input type="number" id="qty-input" class="qty-input" value="1">
            </div>
            <input type="text" id="extra-input" class="extra-input" placeholder="Ø²ÛŒØ§Ø¯Û•Ú©Ø±Ø¯Ù†ÛŒ Ø´Øª (Ù¾Û•Ù†ÛŒØ±ØŒ ÙÛŒÙ†Ú¯Û•Ø±...)">
            <button class="btn-main" onclick="confirmAdd()">Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†</button>
            <button class="btn-cancel" onclick="closeModal('qty-modal')">Ù¾Ø§Ø´Ú¯Û•Ø²Ø¨ÙˆÙˆÙ†Û•ÙˆÛ•</button>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDqoOjm4m1Fxp760mJPy0sv5_NjaJfkm7g",
            databaseURL: "https://boompizza-5d048-default-rtdb.firebaseio.com",
            projectId: "boompizza-5d048",
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let selectedDesk = null;
        let cart = [];
        let currentFood = null;

        function selectDesk(num, btn) {
            selectedDesk = num;
            document.querySelectorAll('.table-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function openFoodModal() { document.getElementById('food-modal').style.display = 'flex'; }
        
        function promptQty(name, price) {
            currentFood = { name, price };
            document.getElementById('modal-food-name').innerText = name;
            document.getElementById('qty-input').value = 1;
            document.getElementById('extra-input').value = "";
            document.getElementById('qty-modal').style.display = 'flex';
        }

        function confirmAdd() {
            const qty = parseInt(document.getElementById('qty-input').value) || 1;
            const extra = document.getElementById('extra-input').value;
            
            cart.push({
                name: currentFood.name,
                price: currentFood.price,
                qty: qty,
                extra: extra,
                total: currentFood.price * qty
            });
            
            closeModal('qty-modal');
            closeModal('food-modal');
            updateUI();
        }

        function removeItem(index) {
            cart.splice(index, 1);
            updateUI();
        }

        function updateUI() {
            const list = document.getElementById('selected-list');
            const totalDisplay = document.getElementById('display-total');
            list.innerHTML = '';
            let grandTotal = 0;

            cart.forEach((item, index) => {
                grandTotal += item.total;
                list.innerHTML += `
                    <div class="item-row">
                        <div class="item-info">
                            <b>${item.qty}x ${item.name}</b>
                            ${item.extra ? `<small>+ ${item.extra}</small>` : ''}
                        </div>
                        <span style="margin-left:10px;">${item.total.toLocaleString()}</span>
                        <button class="del-btn" onclick="removeItem(${index})">Ã—</button>
                    </div>
                `;
            });
            totalDisplay.innerText = grandTotal.toLocaleString() + " Ø¯.Ø¹";
        }

        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        function sendOrder() {
            if (!selectedDesk) return alert("Ù…ÛØ² Ù‡Û•ÚµØ¨Ú˜ÛØ±Û•!");
            if (cart.length === 0) return alert("Ø®ÙˆØ§Ø±Ø¯Ù† Ù‡Û•ÚµØ¨Ú˜ÛØ±Û•!");

            const itemsStr = cart.map(i => `${i.qty}x ${i.name}${i.extra ? '('+i.extra+')' : ''}`).join(' + ');
            const finalTotal = cart.reduce((sum, i) => sum + i.total, 0);

            const orderData = {
                id: Math.floor(1000 + Math.random() * 9000),
                items: itemsStr,
                total: finalTotal.toLocaleString() + " Ø¯.Ø¹",
                phone: "Ù†Ø§ÙˆÛ•ÙˆÛ• (Ù…ÛØ²ÛŒ " + selectedDesk + ")",
                time: new Date().toLocaleString('en-CA', { hour12: false }).replace(',', '')
            };

            db.ref('orders').push(orderData).then(() => {
                alert("Ù†ÛØ±Ø¯Ø±Ø§!");
                location.reload();
            });
        }
    </script>
</body>
</html>

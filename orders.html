// Ù‡ÛÙ†Ø§Ù†Û•ÙˆÛ•ÛŒ Ø¯Ø§ØªØ§ Ùˆ Ú•ÛŒØ²Ú©Ø±Ø¯Ù†ÛŒ Ø¨Û•Ù¾ÛÛŒ Ú©Ø§Øª (Ù†ÙˆÛØªØ±ÛŒÙ† Ø¨Û† Ú©Û†Ù†ØªØ±ÛŒÙ†)
db.ref('orders').on('value', (snapshot) => {
    const listDiv = document.getElementById('list');
    const data = snapshot.val();
    listDiv.innerHTML = '';
    
    let totalSum = 0;
    let count = 0;

    if (data) {
        // Ú¯Û†Ú•ÛŒÙ†ÛŒ Ø¯Ø§ØªØ§Ú©Ø§Ù† Ø¨Û† Ù„ÛŒØ³Øª Ùˆ Ù¾ÛÚ†Û•ÙˆØ§Ù†Û•Ú©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒØ§Ù† Ø¨Û† Ø¦Û•ÙˆÛ•ÛŒ Ù†ÙˆÛØªØ±ÛŒÙ† Ù„Û• Ø³Û•Ø±Û•ÙˆÛ• Ø¨ÛØª
        const sortedKeys = Object.keys(data).reverse(); 
        count = sortedKeys.length;
        
        sortedKeys.forEach(key => {
            const o = data[key];
            let priceValue = o.total ? o.total.toString().replace(/[^0-9]/g, '') : 0;
            totalSum += parseInt(priceValue) || 0;

            listDiv.innerHTML += `
                <div class="order">
                    <div class="head">
                        <span class="id">#${o.id}</span>
                        <small style="color:#888">${o.time || 'Ú©Ø§Øª Ù†Ø§Ø¯ÛŒØ§Ø±Û•'}</small>
                    </div>
                    <div class="items">ğŸ´ ${Array.isArray(o.items) ? o.items.join(' + ') : o.items}</div>
                    ${o.note && o.note !== 'Ù†ÛŒÛŒÛ•' ? `<div style="color:#ffc107; font-size:0.85rem; margin-bottom:10px;">ğŸ’¬ ${o.note}</div>` : ''}
                    <div class="foot">
                        <b style="font-size:1.1rem;">${o.total} Ø¯.Ø¹</b>
                        <a href="tel:${o.phone}" class="call">Ù¾Û•ÛŒÙˆÛ•Ù†Ø¯ÛŒ ğŸ“</a>
                    </div>
                </div>`;
        });
    } else {
        listDiv.innerHTML = '<p style="text-align:center; color:#666;">Ù‡ÛŒÚ† Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒÛŒÛ•Ú© Ù†Û•Ø¯Û†Ø²Ø±Ø§ÛŒÛ•ÙˆÛ•</p>';
    }
    
    document.getElementById('count').innerText = count;
    document.getElementById('sum').innerText = totalSum.toLocaleString() + " Ø¯.Ø¹";
});
